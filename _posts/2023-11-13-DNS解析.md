---
title: DNS解析
description: "DNS解析"
locale: "zh_CN"
author: Xiao Lv
date: 2023-11-13
category: Jekyll
layout: post
---
# DNS的概念与解析过程
DNS（Domain Name System，域名系统）是将域名和IP地址相互映射的一个分布式数据库，是互联网的基础服务之一。DNS解析过程是指将域名转换为IP地址的过程。
DNS解析过程可以分为以下几个步骤：
1. 查看本地缓存
当用户输入一个域名时，首先会在本地缓存中查找是否有该域名的IP地址记录。如果有，则直接返回该记录，解析过程结束。
2. 查询本地DNS服务器
如果本地缓存中没有该域名的IP地址记录，则会向本地DNS服务器发起查询请求。本地DNS服务器会首先查看自己的缓存，如果有该域名的IP地址记录，则直接返回该记录。
3. 查询根域名服务器
如果本地DNS服务器的缓存中也没有该域名的IP地址记录，则会向根域名服务器发起查询请求。根域名服务器会返回该域名的顶级域名服务器的IP地址。
4. 查询顶级域名服务器
本地DNS服务器会向顶级域名服务器发起查询请求，请求该域名的权威域名服务器的IP地址。顶级域名服务器会返回该域名的权威域名服务器的IP地址。
5. 查询权威域名服务器
本地DNS服务器会向权威域名服务器发起查询请求，请求该域名的IP地址。权威域名服务器会返回该域名的IP地址。
6. 保存结果到本地缓存
本地DNS服务器会将解析结果保存到自己的缓存中，以便下次查询时可以直接返回。

DNS解析过程一般需要经过几次查询才能完成，但如果本地缓存中已经有该域名的IP地址记录，则解析过程可以立即完成。
DNS解析过程的效率取决于以下几个因素：
-  **本地缓存的命中率**：本地缓存的命中率越高，DNS解析过程的效率就越高。
- **DNS服务器的性能**：DNS服务器的性能越高，DNS解析过程的效率就越高。
- 网络环境的质量：网络环境的质量越好，DNS解析过程的效率就越高。

为了提高DNS解析的效率，可以采取以下措施：
- 定期更新本地缓存：可以使用第三方工具定期更新本地缓存，以提高本地缓存的命中率。
- 使用高性能的DNS服务器：可以使用高性能的DNS服务器，以提高DNS解析的效率。
- 优化网络环境：可以优化网络环境，以提高DNS解析的效率。
# 服务器
权威域名服务器是指保存域名解析记录的服务器。对于一个特定的域名，必须将域名交由某个DNS服务器进行解析，才能将域名指向对应的IP地址，才能让客户通过域名访问对应的站点。这个负责最终解析域名的服务器就是权威域名服务器。<p>
权威域名服务器通常由域名所有者或域名服务商来维护。权威域名服务器可以根据域名的层次结构分为以下几类：
- 根域名服务器：根域名服务器位于DNS的顶层，负责解析顶级域名（例如.com、.cn等）。
- 顶级域名服务器：顶级域名服务器负责解析二级域名（例如example.com）。
- 权威域名服务器：权威域名服务器负责解析具体的域名（例如www.example.com）。

根域名服务器共有13台，分别位于美国、欧洲、亚洲等多个国家和地区。顶级域名服务器的数量则根据顶级域名的不同而有所不同。
以下是一些常见顶级域名的权威域名服务器：
- com： 
  - 阿里云：114.114.114.114、114.114.115.115
  - 腾讯云：119.28.221.222、119.28.222.222
  - 谷歌：8.8.8.8、8.8.4.4
- cn： 
  - 中国科学院：114.114.114.114、114.114.115.115
  - 中国联通：180.76.76.76、180.76.77.77
  - 中国电信：223.5.5.5、223.6.6.6
  
用户可以通过查询域名解析记录来获取权威域名服务器的IP地址。
# 查询方式
## 递归查询
![递归查询](https://cdn.nlark.com/yuque/0/2023/png/32683951/1699720873673-adf4bb64-bf74-4ae2-8bfe-daba452220e4.png?x-oss-process=image%2Fresize%2Cw_1006%2Climit_0)
## 迭代查询
![迭代查询](https://cdn.nlark.com/yuque/0/2023/png/32683951/1699720937065-0d82998b-69d0-45e0-89eb-1a71a9fff7fc.png?x-oss-process=image%2Fresize%2Cw_1013%2Climit_0)

由于递归查询对于被查询的域名服务器负担太大，通常采用以下模式：从请求主机到本地域名服务器的查询是递归查询，而其余的查询是迭代查询。

>https://g.co/bard/share/9d4d2a4224a0
https://juejin.cn/post/7065238621866950693
